<!DOCTYPE html>


<script>

function htmlDecode(input) {
        const textArea = document.createElement("textarea");
        textArea.innerHTML = input;
        return textArea.value;
      }

const reg = /\{(.*?)\}/g


function store(value){

    this.value = value;


    this.subscribe = (sub) => {
        this.subs.push(sub)


        return () => {
            this.subs.filter(s => s !== sub)
        }
    }

    this.update = (u) => {

        this.value = u(this.value)

        this.subs.forEach(sub => {

            sub(this.value)
        })

    }

    return this;

}






function init(){
        (typeof initialize === "undefined") ? null : initialize()
        const inner = document.getElementsByTagName("main")[0]
    const interpolated =inner.innerHTML.match(reg).map(res => htmlDecode(res)).map(res => {




        return res.replace("{", "").replace("}", "")



    })
        
        interpolated.forEach(match => {

            const fn = new Function(`return ${match}`)

            document.getElementsByTagName("main")[0].innerHTML = inner.innerHTML.replace(match, fn())
             

            console.log(fn())
        })


    }
</script>


<script>



    var [value, s] = ["h", [1, 2, 3, 4]]
    
    

</script>

<main>
    <div>{value}</div>
    <div>{s.map(num => num + "/").toString()}</div>
    <button onclick="h()">hello htere</button>
</main>



<script>
    document.addEventListener("DOMContentLoaded", init)

</script>
